"use strict";function parseWiki(e){return new Promise(function(n,t){try{var r={title:e.title,url:e.title,last_edited:{raw:new Date(e.last_edited.raw),formatted:e.last_edited.formatted},content:e.content.replace(/<span id="[\w.]+">|<\/span>|<noinclude>[\s\S]*?<\/noinclude>|<br\s?\/?>|\[\[Kategorie:.*?]]/g,"")};Array.from(r.content.matchAll(/^(=+)([\w-–§\s,ÄÖÜäöüß:()]+)\1$/gm)).forEach(function(e){var n=e[0],t=e[1],a=e[2],l="h"+(t.length+1);r.content=r.content.replace(n,"<"+l+">"+a+"</"+l+">")}),r.content=r.content.replace(/((?:^\*+ .+$\n)+)/gm,"<ul>\n$1\n</ul>\n").replace(/((?:^\*{2,} .+$\n)+)/gm,"<ul>\n$1\n</ul>\n").replace(/((?:^\*{3,} .+$\n)+)/gm,"<ul>\n$1\n</ul>\n").replace(/((?:^\*{4,} .+$\n)+)/gm,"<ul>\n$1\n</ul>\n").replace(/((?:^\*{5,} .+$\n)+)/gm,"<ul>\n$1\n</ul>\n").replace(/((?:^#+ .+$\n)+)/gm,"<ol>\n$1\n</ol>\n").replace(/((?:^#{2,} .+$\n)+)/gm,"<ol>\n$1\n</ol>\n").replace(/((?:^#{3,} .+$\n)+)/gm,"<ol>\n$1\n</ol>\n").replace(/((?:^#{4,} .+$\n)+)/gm,"<ol>\n$1\n</ol>\n").replace(/((?:^#{5,} .+$\n)+)/gm,"<ol>\n$1\n</ol>\n").replace(/(?:^[*#]+ (.+$))/gm,"<li>$1</li>").replace(/((?:^[;:].+$\n)+)/gm,"<dl>\n$1\n</dl>\n").replace(/(?:^;(.+$))/gm,"<dt>$1</dt>").replace(/(?:^:(.+$))/gm,"<dd>$1</dd>").replace(/('{5})([\s\S]*?)\1/gm,"<strong><em>$2</em></strong>").replace(/('{3})([\s\S]*?)\1/g,"<strong>$2</strong>").replace(/('{2})([\s\S]*?)\1/g,"<em>$2</em>").replace(/^(?!<)((?:.+\n(?!<)|.+)+)/gm,"<p>$1</p>").replace(/\[\[(.+)\|(.+)]]/g,'<a href="https://wiki.piratenpartei.de/$1">$2</a>').replace(/\[((?:https?:)?\/\/.+) (.+)]/g,'<a href="$1">$2</a>').replace(/\[((?:https?:)?\/\/.+)]/g,'<a href="$1">$1</a>'),r.content=r.content.split("\n").filter(function(e){return!/^\s*$/.test(e)}).join("\n"),n(r)}catch(e){t(e)}})}document.querySelectorAll("div.wp-block-piwi-wiki").forEach(function(e){var n={action:"piratenwiki",page:e.dataset.page};fetch(piwi.ajax_url,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},body:Object.entries(n).map(function(e){return e[1]=encodeURIComponent(e[1]),e.join("=")}).join("&")}).then(function(e){return e.json()}).then(function(e){return parseWiki(e)}).then(function(n){var t=n.content,r=n.last_edited,a=n.url,l=n.title,i=document.createElement("div");i.classList.add("wiki-container"),i.innerHTML=t,Array.from(i.querySelectorAll("p, li, dt, dd, h2, h3, h4, h5, h6")).forEach(function(e){return e.innerHTML=e.innerHTML.replace(/(?<!<br\/?>)\n(?!<br\/?>)/g,"<br>")}),Array.from(e.children).forEach(function(e){return e.remove()}),e.prepend(i);var c=document.createElement("footer");c.classList.add("piwi_wiki_footer");var o=document.createElement("p");o.innerText="Stand: ";var p=document.createElement("time");p.dateTime=r.raw.toISOString(),p.innerText=r.formatted,c.appendChild(o).appendChild(p);var d=document.createElement("p"),m=document.createElement("a");m.classList.add("btn"),m.classList.add("external-link-img-wrapper"),m.rel="external",m.target="_blank",m.href=a,m.title='"'+l+'" im Piratenwiki ansehen',m.innerText="Im Piratenwiki ansehen",e.appendChild(c).appendChild(d).appendChild(m)}).catch(function(e){return console.error(e)})});